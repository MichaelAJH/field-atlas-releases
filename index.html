<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Field Atlas — Citation Graph Explorer for Researchers</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #0f1117;
      --surface: #1a1d27;
      --surface-hover: #222632;
      --border: #2a2e3a;
      --text: #e4e4e7;
      --text-muted: #9294a0;
      --accent: #6366f1;
      --accent-hover: #818cf8;
      --green: #22c55e;
      --radius: 10px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    a { color: var(--accent); text-decoration: none; }
    a:hover { color: var(--accent-hover); text-decoration: underline; }

    .container { max-width: 860px; margin: 0 auto; padding: 0 24px; }

    /* ---- Header ---- */
    header {
      padding: 80px 0 48px;
      text-align: center;
    }
    header h1 {
      font-size: 2.8rem;
      font-weight: 700;
      letter-spacing: -0.03em;
      margin-bottom: 12px;
    }
    header .tagline {
      font-size: 1.15rem;
      color: var(--text-muted);
      max-width: 520px;
      margin: 0 auto 40px;
    }

    /* ---- Download buttons ---- */
    .downloads {
      display: flex;
      gap: 14px;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 28px;
      border-radius: var(--radius);
      font-size: 0.95rem;
      font-weight: 600;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text);
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s;
    }
    .btn:hover { background: var(--surface-hover); border-color: var(--accent); text-decoration: none; }
    .btn-primary {
      background: var(--accent);
      border-color: var(--accent);
      color: #fff;
    }
    .btn-primary:hover { background: var(--accent-hover); border-color: var(--accent-hover); }
    .version-note {
      text-align: center;
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-bottom: 48px;
    }

    /* ---- Sections ---- */
    section { padding: 40px 0; }
    section + section { border-top: 1px solid var(--border); }
    section h2 {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 20px;
    }

    /* ---- Quick Start ---- */
    .steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
    }
    .step {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }
    .step-num {
      display: inline-block;
      width: 28px; height: 28px;
      line-height: 28px;
      text-align: center;
      border-radius: 50%;
      background: var(--accent);
      color: #fff;
      font-size: 0.82rem;
      font-weight: 700;
      margin-bottom: 10px;
    }
    .step h3 { font-size: 0.95rem; font-weight: 600; margin-bottom: 4px; }
    .step p { font-size: 0.85rem; color: var(--text-muted); }

    /* ---- Features ---- */
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
    }
    .feature {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }
    .feature h3 { font-size: 0.95rem; font-weight: 600; margin-bottom: 6px; }
    .feature p { font-size: 0.85rem; color: var(--text-muted); }

    /* ---- Requirements ---- */
    .req-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    @media (max-width: 560px) { .req-grid { grid-template-columns: 1fr; } }
    .req-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
    }
    .req-card h3 { font-size: 0.95rem; font-weight: 600; margin-bottom: 6px; }
    .req-card p, .req-card li { font-size: 0.85rem; color: var(--text-muted); }
    .req-card ul { padding-left: 18px; }
    .badge {
      display: inline-block;
      font-size: 0.72rem;
      font-weight: 600;
      padding: 2px 8px;
      border-radius: 4px;
      margin-left: 6px;
      vertical-align: middle;
    }
    .badge-required { background: #7c3aed33; color: #a78bfa; }
    .badge-optional { background: #16a34a22; color: #4ade80; }

    /* ---- Footer ---- */
    footer {
      padding: 40px 0;
      border-top: 1px solid var(--border);
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    footer .links { margin-bottom: 8px; }
    footer .links a { margin: 0 12px; }

    code {
      background: var(--surface);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.85em;
    }
  </style>
</head>
<body>

  <div class="container">

    <!-- Header -->
    <header>
      <h1>Field Atlas</h1>
      <p class="tagline">
        An interactive citation graph explorer that helps researchers navigate unfamiliar academic fields.
      </p>
      <div class="downloads">
        <a id="dl-mac" class="btn" href="https://github.com/MichaelAJH/field-atlas-releases/releases/latest">
          macOS (.dmg)
        </a>
        <a id="dl-win" class="btn" href="https://github.com/MichaelAJH/field-atlas-releases/releases/latest">
          Windows (.exe)
        </a>
        <a id="dl-linux" class="btn" href="https://github.com/MichaelAJH/field-atlas-releases/releases/latest">
          Linux (.AppImage)
        </a>
      </div>
      <p class="version-note" id="version-note">
        Free &amp; open source &middot;
        <a href="https://github.com/MichaelAJH/field-atlas-releases/releases">All releases</a>
      </p>
    </header>

    <!-- Quick Start -->
    <section>
      <h2>Quick Start</h2>
      <div class="steps">
        <div class="step">
          <div class="step-num">1</div>
          <h3>Install Ollama</h3>
          <p>Download from <a href="https://ollama.com/download">ollama.com</a>, then run <code>ollama pull llama3</code>.</p>
        </div>
        <div class="step">
          <div class="step-num">2</div>
          <h3>Download Field Atlas</h3>
          <p>Grab the installer for your platform from the buttons above.</p>
        </div>
        <div class="step">
          <div class="step-num">3</div>
          <h3>Launch</h3>
          <p>Open the app. Make sure Ollama is running (<code>ollama serve</code>).</p>
        </div>
        <div class="step">
          <div class="step-num">4</div>
          <h3>Explore</h3>
          <p>Type a research topic and explore the citation graph that appears in seconds.</p>
        </div>
      </div>
    </section>

    <!-- Features -->
    <section>
      <h2>Features</h2>
      <div class="features">
        <div class="feature">
          <h3>Smart Query Expansion</h3>
          <p>Your query is expanded into multiple search variants to discover papers you'd otherwise miss.</p>
        </div>
        <div class="feature">
          <h3>Interactive Citation Graph</h3>
          <p>Force-directed D3.js visualization with chronological layout. Zoom, pan, click to explore.</p>
        </div>
        <div class="feature">
          <h3>AI-Powered Summaries</h3>
          <p>Hover any paper for an LLM-generated summary. Hover an edge to understand citation relationships.</p>
        </div>
        <div class="feature">
          <h3>Structural Analysis</h3>
          <p>PageRank, centrality, clustering, and fundamental paper identification — computed automatically.</p>
        </div>
        <div class="feature">
          <h3>Adjustable Controls</h3>
          <p>Toggle search variants, switch ranking presets (Overview / Balanced / Expert), or fine-tune with sliders.</p>
        </div>
        <div class="feature">
          <h3>Export &amp; Load Sessions</h3>
          <p>Save your entire exploration as JSON. Reload it later to pick up exactly where you left off.</p>
        </div>
      </div>
    </section>

    <!-- System Requirements -->
    <section>
      <h2>System Requirements</h2>
      <div class="req-grid">
        <div class="req-card">
          <h3>Ollama <span class="badge badge-optional">Recommended</span></h3>
          <p>Free, local LLM runtime. Needed for AI summaries and query expansion when using local models.</p>
          <ul>
            <li>~4 GB for one model (llama3, mistral, etc.)</li>
            <li>Not needed if using Claude or OpenAI API keys</li>
          </ul>
        </div>
        <div class="req-card">
          <h3>Disk Space</h3>
          <ul>
            <li>App: ~200 MB</li>
            <li>Sentence-transformer model: ~80 MB (downloads on first run)</li>
            <li>Ollama model: ~4 GB</li>
          </ul>
        </div>
        <div class="req-card">
          <h3>Operating System</h3>
          <ul>
            <li>macOS 11+ (Intel &amp; Apple Silicon)</li>
            <li>Windows 10+</li>
            <li>Linux (glibc 2.31+)</li>
          </ul>
        </div>
        <div class="req-card">
          <h3>Alternative LLM Providers</h3>
          <p>Instead of Ollama you can use:</p>
          <ul>
            <li>Claude (Anthropic API key)</li>
            <li>OpenAI (GPT-4o-mini)</li>
          </ul>
          <p>Configure in app Settings.</p>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="links">
        <a href="docs/user-guide.md">User Guide</a>
        <a href="docs/troubleshooting.md">Troubleshooting</a>
        <a href="CHANGELOG.md">Changelog</a>
        <a href="https://github.com/MichaelAJH/field-atlas-releases/issues">Report a Bug</a>
      </div>
      <p>Field Atlas is free and open source.</p>
    </footer>

  </div>

  <script>
    (function () {
      var REPO = 'MichaelAJH/field-atlas-releases';
      var API  = 'https://api.github.com/repos/' + REPO + '/releases/latest';

      // Map file extensions to button IDs
      var EXT_MAP = { '.dmg': 'dl-mac', '.exe': 'dl-win', '.AppImage': 'dl-linux' };

      // Detect user OS and highlight matching button
      var ua = navigator.userAgent || navigator.platform || '';
      var detectedId = /Mac/i.test(ua) ? 'dl-mac'
                     : /Win/i.test(ua) ? 'dl-win'
                     : /Linux/i.test(ua) ? 'dl-linux'
                     : 'dl-mac';
      var el = document.getElementById(detectedId);
      if (el) el.classList.add('btn-primary');

      function formatSize(bytes) {
        if (bytes >= 1e9) return (bytes / 1e9).toFixed(1) + ' GB';
        if (bytes >= 1e6) return (bytes / 1e6).toFixed(0) + ' MB';
        return bytes + ' B';
      }

      fetch(API)
        .then(function (r) { return r.json(); })
        .then(function (release) {
          // Update version note
          var note = document.getElementById('version-note');
          if (note && release.tag_name) {
            note.innerHTML = 'Latest: <strong>' + release.tag_name + '</strong> &middot; Free &amp; open source &middot; '
              + '<a href="https://github.com/' + REPO + '/releases">All releases</a>';
          }

          // Update each download button with direct asset URL and size
          (release.assets || []).forEach(function (asset) {
            var name = asset.name || '';
            Object.keys(EXT_MAP).forEach(function (ext) {
              if (name.endsWith(ext)) {
                var btn = document.getElementById(EXT_MAP[ext]);
                if (btn) {
                  btn.href = asset.browser_download_url;
                  var label = ext === '.dmg' ? 'macOS' : ext === '.exe' ? 'Windows' : 'Linux';
                  btn.textContent = label + ' (' + ext.slice(1) + ') \u2014 ' + formatSize(asset.size);
                }
              }
            });
          });
        })
        .catch(function () { /* fallback: buttons still link to /releases/latest */ });
    })();
  </script>

</body>
</html>
